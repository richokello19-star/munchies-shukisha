<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- ===== ENHANCED SEO META TAGS ===== -->
    <title>Munchies & Shukisha | Kenya's Local Chef Marketplace - Order Food Delivery</title>
    <meta name="description" content="Order authentic local cuisine from home chefs & restaurants in Kenya. Fast food delivery with Munchies & Shukisha - Every bite's a party!">
    <meta name="keywords" content="food delivery kenya, local chefs, restaurants nairobi, order food online, home cooked meals, munchies shukisha, kenyan food">
    <meta name="author" content="Munchies & Shukisha">
    
    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:title" content="Munchies & Shukisha | Kenya's Local Chef Marketplace">
    <meta property="og:description" content="Order authentic local cuisine from home chefs & restaurants in Kenya. Fast delivery - Every bite's a party!">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://munchiesandshukisha.netlify.app">
    <meta property="og:image" content="https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-1.2.1&auto=format&fit=crop&w=1200&q=80">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="Munchies & Shukisha">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Munchies & Shukisha | Kenya's Local Chef Marketplace">
    <meta name="twitter:description" content="Order authentic local cuisine from home chefs & restaurants in Kenya">
    <meta name="twitter:image" content="https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-1.2.1&auto=format&fit=crop&w=1200&q=80">
    
    <!-- Additional Important Meta Tags -->
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#11151C">
    <meta name="msapplication-TileColor" content="#11151C">
    
    <!-- Mobile-specific meta tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Munchies & Shukisha">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="HandheldFriendly" content="true">
    <meta name="MobileOptimized" content="width">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://munchiesandshukisha.netlify.app">
    
    <!-- Structured Data / Schema.org -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FoodEstablishment",
      "name": "Munchies & Shukisha",
      "description": "Kenya's Local Chef Marketplace - Order from home chefs & restaurants near you",
      "url": "https://munchiesandshukisha.netlify.app",
      "image": "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-1.2.1&auto=format&fit=crop&w=1200&q=80",
      "address": {
        "@type": "PostalAddress",
        "addressCountry": "KE"
      },
      "servesCuisine": ["Kenyan", "African", "Local Cuisine"],
      "priceRange": "$$"
    }
    </script>

    <!-- ===== PERFORMANCE OPTIMIZATIONS ===== -->
    <!-- Preload critical resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Pacifico&family=Montserrat:wght@400;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    
    <!-- DNS prefetch for external domains -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="https://images.unsplash.com">
    
    <!-- Preconnect to critical origins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    
    <!-- Favicon improvements -->
    <link rel="icon" href="munchies-logo.png" type="image/png">
    <link rel="apple-touch-icon" href="munchies-logo.png">
    
    <!-- Existing styles and fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #11151C;
            --secondary: #38b6ff;
            --accent: #E63946;
            --light: #F1FAEE;
            --whatsapp: #25D366;
            --whatsapp-hover: #128C7E;
            --gold: #FFD700;
            --success: #4CAF50;
            --warning: #FF9800;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        /* ===== ACCESSIBILITY: REDUCED MOTION SUPPORT ===== */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }
        
        body {
            font-family: 'Montserrat', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light);
            color: var(--primary);
            position: relative;
            min-height: 100vh;
            padding-bottom: 100px;
            line-height: 1.6;
            padding-top: 150px; /* Added for fixed header */
            font-display: swap;
        }
        
        /* ===== ACCESSIBILITY: SKIP TO CONTENT LINK ===== */
        .skip-to-content {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--secondary);
            color: white;
            padding: 8px;
            text-decoration: none;
            border-radius: 4px;
            z-index: 10000;
            transition: top 0.3s ease;
        }
        
        .skip-to-content:focus {
            top: 6px;
        }
        
        /* ===== MOBILE RESPONSIVENESS FIXES ===== */
        @media (max-width: 768px) {
            body {
                padding-top: 120px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding-top: 100px;
            }
        }

        /* Improved touch targets for mobile */
        @media (max-width: 768px) {
            button, 
            .btn,
            a.nav-link,
            nav a {
                min-height: 44px;
                min-width: 44px;
                padding: 12px 16px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            /* Larger form elements for mobile */
            input, select, textarea {
                font-size: 16px !important; /* Prevents zoom on iOS */
                padding: 12px !important;
                min-height: 44px !important;
            }
            
            /* Better mobile typography */
            body {
                font-size: 16px;
                line-height: 1.5;
            }
            
            h1 {
                font-size: 1.8rem !important;
            }
            
            h2 {
                font-size: 1.5rem !important;
            }
            
            h3 {
                font-size: 1.3rem !important;
            }
            
            .small-text {
                font-size: 0.9rem !important;
            }
        }
        
        /* Header Styles */
        header {
            background-color: var(--primary);
            color: white;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            transition: all 0.4s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateZ(0);
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            transition: all 0.4s ease;
        }
        
        .logo-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 15px;
            transition: all 0.4s ease;
        }
        
        .logo {
            font-size: 2.5rem;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 15px;
            letter-spacing: -0.5px;
            transition: all 0.4s ease;
        }
        
        .logo-icon {
            height: 50px;
            width: 50px;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            background: linear-gradient(135deg, var(--secondary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            transition: all 0.4s ease;
            overflow: hidden;
        }
        
        .logo-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .brand-names {
            font-family: 'Pacifico', cursive;
            font-size: 1.8rem;
            margin-top: 8px;
            color: var(--secondary);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            transition: all 0.4s ease;
        }
        
        nav ul {
            list-style: none;
            padding: 0;
            display: flex;
            justify-content: center;
            gap: 25px;
            flex-wrap: wrap;
            transition: all 0.4s ease;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            border-radius: 30px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        nav a:hover {
            background-color: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }
        
        nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 3px;
            background-color: var(--secondary);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }
        
        nav a:hover::after {
            width: 70%;
        }
        
        .nav-text {
            transition: all 0.4s ease;
        }
        
        /* Header scrolled state */
        header.scrolled {
            padding: 5px 0;
        }
        
        header.scrolled .header-content {
            padding: 5px 20px;
        }
        
        header.scrolled .logo-container {
            flex-direction: row;
            align-items: center;
            margin-bottom: 0;
            gap: 10px;
        }
        
        header.scrolled .logo {
            font-size: 1.5rem;
            gap: 10px;
        }
        
        header.scrolled .logo-icon {
            height: 35px;
            width: 35px;
            font-size: 18px;
        }
        
        header.scrolled .brand-names {
            font-size: 1.2rem;
            margin-top: 0;
        }
        
        header.scrolled .nav-text {
            display: none;
        }
        
        header.scrolled nav ul {
            gap: 15px;
        }
        
        header.scrolled nav a {
            padding: 6px 12px;
            font-size: 0.9rem;
        }
        
        /* Mobile header adjustments */
        @media (max-width: 768px) {
            header.scrolled .logo-container {
                flex-direction: column;
                align-items: center;
                gap: 5px;
            }
            
            header.scrolled .logo {
                font-size: 1.2rem;
            }
            
            header.scrolled .brand-names {
                font-size: 1rem;
            }
            
            header.scrolled nav ul {
                gap: 8px;
            }
            
            header.scrolled nav a {
                padding: 4px 8px;
                font-size: 0.8rem;
            }
            
            /* Mobile navigation improvements */
            nav ul {
                gap: 15px;
            }
            
            nav a {
                font-size: 0.9rem;
                padding: 10px 16px;
            }
        }

        .hero {
            background: linear-gradient(135deg, rgba(17, 21, 28, 0.85) 0%, rgba(17, 21, 28, 0.7) 100%), 
                        url('https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-1.2.1&auto=format&fit=crop&w=1600&q=80');
            background-size: cover;
            background-position: center;
            height: 500px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
            position: relative;
            padding: 0 20px;
            will-change: transform;
        }
        
        .hero-content {
            max-width: 800px;
            padding: 30px;
            background: rgba(17, 21, 28, 0.7);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .hero h1 {
            font-size: 3.5rem;
            margin: 0 0 20px;
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
            line-height: 1.2;
        }
        
        .hero p {
            font-size: 1.5rem;
            margin: 0 0 30px;
            opacity: 0.9;
        }
        
        .btn-container {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            display: inline-block;
            background-color: var(--secondary);
            color: white;
            padding: 14px 32px;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.1rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(56, 182, 255, 0.3);
            position: relative;
            overflow: hidden;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(56, 182, 255, 0.4);
        }
        
        .btn:active {
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background-color: transparent;
            border: 2px solid white;
        }
        
        .vendor-badge {
            background: var(--gold);
            color: #333;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: inline-block;
            margin-bottom: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .menu {
            padding: 70px 20px;
            text-align: center;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .menu-header {
            margin-bottom: 50px;
        }
        
        .menu h2 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            color: var(--primary);
            position: relative;
            display: inline-block;
        }
        
        .menu h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: var(--secondary);
            border-radius: 2px;
        }
        
        .menu p {
            font-size: 1.2rem;
            color: #666;
            max-width: 700px;
            margin: 0 auto 30px;
        }
        
        .menu-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 40px;
            margin-top: 30px;
        }
        
        .menu-item {
            background-color: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            display: flex;
            flex-direction: column;
            height: 100%;
            cursor: pointer;
            transform: translateZ(0);
            backface-visibility: hidden;
            animation: slideUp 0.5s ease forwards;
            opacity: 0;
        }

        .menu-item:nth-child(1) { animation-delay: 0.1s; }
        .menu-item:nth-child(2) { animation-delay: 0.2s; }
        .menu-item:nth-child(3) { animation-delay: 0.3s; }
        .menu-item:nth-child(4) { animation-delay: 0.4s; }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .menu-item:hover {
            transform: translateY(-15px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .menu-item-img {
            width: 100%;
            height: 220px;
            object-fit: cover;
            transition: transform 0.3s ease;
            loading: lazy;
            decoding: async;
            aspect-ratio: 16/9;
        }
        
        .menu-item:hover .menu-item-img {
            transform: scale(1.05);
        }
        
        .menu-item-content {
            padding: 25px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .menu-item h3 {
            margin: 0 0 12px;
            font-size: 1.6rem;
            color: var(--primary);
        }
        
        .menu-item p {
            margin: 12px 0;
            color: #555;
            flex-grow: 1;
        }
        
        .rating {
            color: var(--gold);
            margin: 10px 0;
            font-size: 1.1rem;
        }
        
        .price {
            font-weight: 800;
            color: var(--accent);
            font-size: 1.8rem;
            margin: 15px 0;
        }
        
        footer {
            background-color: var(--primary);
            color: white;
            text-align: center;
            padding: 30px 0;
            position: absolute;
            bottom: 0;
            width: 100%;
        }

        /* ===== USER EXPERIENCE: SKELETON LOADING ===== */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 8px;
        }

        .skeleton-text {
            height: 1rem;
            margin-bottom: 0.5rem;
        }

        .skeleton-title {
            height: 2rem;
            margin-bottom: 1rem;
        }

        .skeleton-image {
            height: 220px;
            width: 100%;
        }

        @keyframes loading {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }

        /* ===== USER EXPERIENCE: PROGRESS INDICATOR ===== */
        .progress-bar {
            width: 100%;
            height: 4px;
            background-color: #f0f0f0;
            border-radius: 2px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--secondary);
            transition: width 0.3s ease;
            width: 0%;
        }

        /* Auth Modals */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .auth-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            z-index: 1001;
            width: 450px;
            max-width: 95%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalFadeIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translate(-50%, -55%) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .auth-modal h2 {
            margin-top: 0;
            color: var(--primary);
            text-align: center;
            font-size: 2rem;
            margin-bottom: 25px;
        }

        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        .auth-modal input, 
        .auth-modal select,
        .auth-modal textarea {
            width: 100%;
            padding: 14px;
            margin: 8px 0;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            box-sizing: border-box;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .auth-modal input:focus, 
        .auth-modal select:focus,
        .auth-modal textarea:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(56, 182, 255, 0.2);
        }

        .auth-modal button {
            width: 100%;
            padding: 14px;
            background-color: var(--secondary);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(56, 182, 255, 0.3);
        }

        .auth-modal button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(56, 182, 255, 0.4);
        }

        .auth-modal .close {
            position: absolute;
            top: 20px;
            right: 20px;
            cursor: pointer;
            font-size: 24px;
            color: #999;
            transition: all 0.3s ease;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .auth-modal .close:hover {
            color: var(--accent);
            background: rgba(230, 57, 70, 0.1);
        }

        .auth-modal .switch-form {
            text-align: center;
            margin-top: 25px;
            font-size: 1rem;
            color: #666;
        }

        .auth-modal .switch-form a {
            color: var(--secondary);
            cursor: pointer;
            font-weight: 700;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .auth-modal .switch-form a:hover {
            color: var(--primary);
            text-decoration: underline;
        }

        /* Google Button Styles */
        .btn-google {
            width: 100%;
            padding: 14px;
            background: white;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s ease;
        }

        .btn-google:hover {
            border-color: #ddd;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .btn-google img {
            width: 20px;
            height: 20px;
        }

        /* Shopping Cart */
        .cart-icon {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: var(--secondary);
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 25px rgba(56, 182, 255, 0.4);
            cursor: pointer;
            z-index: 99;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .cart-icon:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 12px 30px rgba(56, 182, 255, 0.5);
        }

        .cart-icon i {
            font-size: 28px;
            color: white;
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--accent);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 700;
            box-shadow: 0 3px 10px rgba(230, 57, 70, 0.4);
        }

        /* Social Icons */
        .social-icons {
            position: fixed;
            bottom: 30px;
            left: 30px;
            display: flex;
            gap: 18px;
            z-index: 99;
        }

        .social-icons a {
            color: var(--primary);
            font-size: 26px;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            background: rgba(255, 255, 255, 0.9);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        }

        .social-icons a:hover {
            transform: translateY(-8px) scale(1.15);
            background: var(--secondary);
            color: white;
            box-shadow: 0 8px 20px rgba(56, 182, 255, 0.4);
        }

        /* Dark mode for social icons when on dark backgrounds */
        .dark-bg .social-icons a {
            color: white;
            background: rgba(0, 0, 0, 0.5);
        }

        .dark-bg .social-icons a:hover {
            background: var(--secondary);
            color: white;
        }

        /* Protected Content Overlay */
        .protected-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 1002;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            backdrop-filter: blur(10px);
        }

        .protected-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            color: var(--primary);
            max-width: 500px;
            width: 90%;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            animation: modalFadeIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .protected-content h2 {
            font-size: 2.2rem;
            margin-bottom: 15px;
            color: var(--accent);
        }

        .protected-content p {
            font-size: 1.2rem;
            margin-bottom: 25px;
            color: #666;
        }

        /* Add to Cart Button */
        .add-to-cart {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--secondary);
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            z-index: 10;
        }

        .menu-item:hover .add-to-cart {
            opacity: 1;
            transform: scale(1.1);
        }

        .add-to-cart:hover {
            transform: scale(1.2);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

        .add-to-cart i {
            font-size: 18px;
        }

        /* Vendor Fields */
        #vendorFields {
            display: none;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 2px dashed #e1e5e9;
        }

        #vendorFields input, 
        #vendorFields select, 
        #vendorFields textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
        }

        #vendorFields textarea {
            min-height: 100px;
            resize: vertical;
        }

        #vendorFields small {
            font-size: 0.9rem;
            color: #666;
            margin-top: -5px;
            margin-bottom: 5px;
            display: block;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 100px;
            right: 30px;
            background-color: var(--primary);
            color: white;
            padding: 16px 28px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            z-index: 1003;
            animation: toastFade 4s forwards;
            display: none;
            max-width: 350px;
            font-weight: 500;
            border-left: 4px solid var(--secondary);
        }

        .toast.error {
            background-color: var(--accent);
            border-left-color: #c00;
        }

        .toast.success {
            background-color: var(--success);
            border-left-color: #2e7d32;
        }

        @keyframes toastFade {
            0% { opacity: 0; transform: translateX(100%); }
            10% { opacity: 1; transform: translateX(0); }
            90% { opacity: 1; transform: translateX(0); }
            100% { opacity: 0; transform: translateX(100%); }
        }

        /* ===== ACCESSIBILITY: FOCUS STYLES ===== */
        button:focus, a:focus, input:focus, select:focus, textarea:focus {
            outline: 3px solid var(--secondary);
            outline-offset: 2px;
        }

        /* ===== ACCESSIBILITY: HIGH CONTRAST SUPPORT ===== */
        @media (prefers-contrast: high) {
            :root {
                --primary: #000000;
                --secondary: #0066CC;
                --accent: #CC0000;
                --light: #FFFFFF;
            }
            
            .btn {
                border: 2px solid var(--primary);
            }
        }

        /* Features Section */
        .features {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 80px 20px;
            text-align: center;
        }

        .features h2 {
            font-size: 2.5rem;
            margin-bottom: 50px;
            color: var(--primary);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .feature-card {
            background: white;
            padding: 40px 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            transform: translateZ(0);
            backface-visibility: hidden;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
        }

        .feature-icon {
            font-size: 3.5rem;
            color: var(--secondary);
            margin-bottom: 20px;
        }

        .feature-card h3 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .feature-card p {
            color: #666;
            font-size: 1.1rem;
            line-height: 1.7;
        }

        /* Restaurant Detail Page Styles */
        .restaurant-detail {
            padding: 40px 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            margin-bottom: 30px;
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            padding: 10px 20px;
            border-radius: 30px;
            background: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .back-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }

        .back-button i {
            margin-right: 8px;
        }

        .restaurant-header {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 40px;
        }

        .restaurant-hero {
            position: relative;
            height: 400px;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        .restaurant-hero img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            loading: lazy;
            decoding: async;
        }

        .restaurant-info {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        }

        .restaurant-title {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .restaurant-title h1 {
            font-size: 2.5rem;
            color: var(--primary);
            margin-right: 20px;
        }

        .restaurant-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 25px;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #666;
            font-size: 0.95rem;
        }

        .meta-item i {
            color: var(--secondary);
        }

        .restaurant-description {
            margin-bottom: 25px;
            line-height: 1.8;
            color: #555;
        }

        .restaurant-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .menu-section {
            margin-top: 60px;
        }

        .menu-section h2 {
            font-size: 2.2rem;
            margin-bottom: 30px;
            color: var(--primary);
            position: relative;
            display: inline-block;
        }

        .menu-section h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 60px;
            height: 4px;
            background: var(--secondary);
            border-radius: 2px;
        }

        .menu-category {
            margin-bottom: 50px;
        }

        .menu-category h3 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: var(--primary);
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }

        .menu-items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }

        .menu-item-detail {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            transform: translateZ(0);
            backface-visibility: hidden;
        }

        .menu-item-detail:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .menu-item-img-detail {
            width: 100%;
            height: 200px;
            object-fit: cover;
            loading: lazy;
            decoding: async;
        }

        .menu-item-content-detail {
            padding: 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .menu-item-content-detail h4 {
            font-size: 1.4rem;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .menu-item-content-detail p {
            color: #666;
            margin-bottom: 15px;
            flex-grow: 1;
        }

        .menu-item-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }

        .price-detail {
            font-weight: 800;
            color: var(--accent);
            font-size: 1.4rem;
        }

        .add-to-cart-detail {
            background: var(--secondary);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(56, 182, 255, 0.3);
        }

        .add-to-cart-detail:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 15px rgba(56, 182, 255, 0.4);
        }

        .reviews-section {
            margin-top: 60px;
        }

        .reviews-section h2 {
            font-size: 2.2rem;
            margin-bottom: 30px;
            color: var(--primary);
            position: relative;
            display: inline-block;
        }

        .reviews-section h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 60px;
            height: 4px;
            background: var(--secondary);
            border-radius: 2px;
        }

        .review-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .reviewer {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .reviewer-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
        }

        .reviewer-info h4 {
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .review-date {
            color: #888;
            font-size: 0.9rem;
        }

        .review-content p {
            line-height: 1.7;
            color: #555;
        }

        /* Checkout Modal */
        .checkout-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            z-index: 1001;
            width: 500px;
            max-width: 95%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalFadeIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .checkout-modal h2 {
            margin-top: 0;
            color: var(--primary);
            text-align: center;
            font-size: 2rem;
            margin-bottom: 25px;
        }

        .checkout-items {
            margin-bottom: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .checkout-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .checkout-total {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
            font-size: 1.2rem;
            padding: 15px 0;
            border-top: 2px solid var(--secondary);
            margin-top: 10px;
        }

        /* Payment Form */
        .payment-form {
            margin-top: 20px;
        }

        .payment-options {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .payment-option {
            flex: 1;
            padding: 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .payment-option.active {
            border-color: var(--secondary);
            background-color: rgba(56, 182, 255, 0.1);
        }

        .payment-option i {
            font-size: 24px;
            margin-bottom: 10px;
            display: block;
        }

        /* File Upload Styling */
        .file-upload-container {
            margin-bottom: 20px;
        }

        .file-upload-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary);
        }

        .file-upload-box {
            border: 2px dashed #e1e5e9;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .file-upload-box:hover {
            border-color: var(--secondary);
            background: #f1f8ff;
        }

        .file-upload-box i {
            font-size: 3rem;
            color: var(--secondary);
            margin-bottom: 15px;
        }

        .file-upload-box p {
            color: #666;
            margin-bottom: 15px;
            font-size: 1rem;
        }

        .file-upload-box span {
            color: #999;
            font-size: 0.9rem;
        }

        .file-upload-box input[type="file"] {
            display: none;
        }

        .image-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }

        .preview-item {
            position: relative;
            width: 150px;
            height: 150px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .preview-item .remove-image {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--accent);
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
        }

        /* Vendor Dashboard Link */
        #vendorDashboardLink {
            display: none;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .empty-state i {
            font-size: 4rem;
            color: #ddd;
            margin-bottom: 20px;
        }

        .empty-state h3 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: #555;
        }

        /* ENHANCED AUTH STYLES */
        .auth-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .auth-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--secondary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 32px;
            box-shadow: 0 8px 20px rgba(56, 182, 255, 0.3);
        }
        
        .form-input-group {
            position: relative;
            margin-bottom: 25px;
        }
        
        .form-input-group input {
            padding: 16px 20px;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            width: 100%;
            font-size: 16px;
            transition: all 0.3s ease;
            background-color: #f8f9fa;
        }
        
        .form-input-group input:focus {
            border-color: var(--secondary);
            background-color: white;
            box-shadow: 0 0 0 3px rgba(56, 182, 255, 0.2);
        }
        
        .form-input-group label {
            position: absolute;
            top: 16px;
            left: 20px;
            color: #666;
            font-size: 16px;
            font-weight: 400;
            pointer-events: none;
            transition: all 0.3s ease;
        }
        
        .form-input-group input:focus + label,
        .form-input-group input:not(:placeholder-shown) + label {
            top: -10px;
            left: 15px;
            font-size: 12px;
            font-weight: 600;
            color: var(--secondary);
            background-color: white;
            padding: 0 8px;
        }
        
        .password-toggle {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        
        .password-toggle:hover {
            color: var(--secondary);
        }
        
        .remember-forgot {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .remember-me {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #666;
        }
        
        .remember-me input {
            width: 16px;
            height: 16px;
        }
        
        .forgot-password {
            color: var(--secondary);
            font-size: 14px;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .forgot-password:hover {
            color: var(--primary);
            text-decoration: underline;
        }
        
        .divider {
            display: flex;
            align-items: center;
            margin: 25px 0;
            color: #999;
        }
        
        .divider::before,
        .divider::after {
            content: "";
            flex: 1;
            height: 1px;
            background-color: #e1e5e9;
        }
        
        .divider span {
            padding: 0 15px;
            font-size: 14px;
        }
        
        .social-login {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .social-btn {
            flex: 1;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }
        
        .social-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .social-btn.facebook {
            color: #1877F2;
        }
        
        .social-btn.facebook:hover {
            border-color: #1877F2;
            background-color: rgba(24, 119, 242, 0.05);
        }
        
        .social-btn.google {
            color: #DB4437;
        }
        
        .social-btn.google:hover {
            border-color: #DB4437;
            background-color: rgba(219, 68, 55, 0.05);
        }
        
        .auth-footer {
            text-align: center;
            margin-top: 25px;
            font-size: 14px;
            color: #666;
        }
        
        .auth-footer a {
            color: var(--secondary);
            font-weight: 600;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .auth-footer a:hover {
            color: var(--primary);
            text-decoration: underline;
        }
        
        .loading {
            position: relative;
            pointer-events: none;
            opacity: 0.8;
        }
        
        .loading::after {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .form-error {
            color: var(--accent);
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }
        
        .form-input-group.error input {
            border-color: var(--accent);
        }
        
        .form-input-group.error .form-error {
            display: block;
        }

        /* ===== MOBILE ENHANCEMENTS: CAROUSEL ===== */
        .carousel {
            position: relative;
            overflow: hidden;
            border-radius: 15px;
        }

        .carousel-track {
            display: flex;
            transition: transform 0.5s ease;
        }

        .carousel-slide {
            min-width: 100%;
            position: relative;
        }

        .carousel-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
        }

        .carousel-nav.prev {
            left: 10px;
        }

        .carousel-nav.next {
            right: 10px;
        }

        .carousel-dots {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 15px;
        }

        .carousel-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #ddd;
            border: none;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .carousel-dot.active {
            background: var(--secondary);
        }

        /* ===== ENHANCED MOBILE OPTIMIZATIONS ===== */
        @media (max-width: 768px) {
            .hero {
                height: 400px;
                background-attachment: scroll;
                padding: 0 15px;
            }
            
            .hero h1 {
                font-size: 2.5rem;
                line-height: 1.3;
            }
            
            .hero p {
                font-size: 1.2rem;
                margin-bottom: 25px;
            }
            
            .hero-content {
                padding: 25px 20px;
                margin: 0 10px;
            }
            
            .btn-container {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
            
            .btn {
                width: 100%;
                max-width: 280px;
                padding: 16px 24px;
                font-size: 1.1rem;
            }
            
            .menu {
                padding: 50px 15px;
            }
            
            .menu h2 {
                font-size: 2.2rem;
            }
            
            .menu p {
                font-size: 1.1rem;
                padding: 0 10px;
            }
            
            .menu-items {
                grid-template-columns: 1fr;
                gap: 25px;
                padding: 0 10px;
            }
            
            .menu-item {
                margin: 0 auto;
                max-width: 400px;
            }
            
            .menu-item-content {
                padding: 20px;
            }
            
            .menu-item h3 {
                font-size: 1.4rem;
            }
            
            .price {
                font-size: 1.6rem;
            }
            
            .social-icons {
                bottom: 110px;
                left: 50%;
                transform: translateX(-50%);
            }
            
            .cart-icon {
                bottom: 20px;
                right: 20px;
                width: 60px;
                height: 60px;
            }
            
            .auth-modal {
                width: 95%;
                padding: 30px;
            }
            
            .restaurant-title {
                flex-direction: column;
                gap: 15px;
            }
            
            .restaurant-title h1 {
                font-size: 2rem;
            }
            
            .restaurant-hero {
                height: 250px;
            }
            
            .menu-items-grid {
                grid-template-columns: 1fr;
            }
            
            .restaurant-actions {
                flex-direction: column;
            }
            
            .payment-options {
                flex-direction: column;
            }
            
            .preview-item {
                width: 100px;
                height: 100px;
            }
            
            /* Enhanced auth mobile styles */
            .social-login {
                flex-direction: column;
            }
            
            .auth-icon {
                width: 60px;
                height: 60px;
                font-size: 24px;
            }

            /* Mobile swipe improvements */
            .menu-item {
                -webkit-overflow-scrolling: touch;
            }
        }

        @media (max-width: 480px) {
            .hero {
                height: 350px;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .hero p {
                font-size: 1.1rem;
            }
            
            .logo {
                font-size: 2rem;
            }
            
            .brand-names {
                font-size: 1.5rem;
            }
            
            .menu h2 {
                font-size: 1.8rem;
            }
            
            .menu-items {
                gap: 20px;
            }
            
            .menu-item-img {
                height: 180px;
            }
            
            .restaurant-info {
                padding: 20px;
            }
            
            .file-upload-box {
                padding: 20px;
            }
            
            .file-upload-box i {
                font-size: 2.5rem;
            }
            
            /* Enhanced auth mobile styles */
            .auth-modal {
                padding: 25px;
            }
            
            .auth-icon {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
            
            /* Ensure all interactive elements are mobile-friendly */
            select, button, [role="button"] {
                touch-action: manipulation;
            }
            
            /* Prevent horizontal scrolling */
            body {
                overflow-x: hidden;
                width: 100%;
            }
            
            /* Improve tap highlights */
            a, button {
                -webkit-tap-highlight-color: rgba(56, 182, 255, 0.3);
            }
        }

        /* Additional mobile-first improvements */
        @media (max-width: 360px) {
            body {
                padding-top: 90px;
            }
            
            .hero {
                height: 300px;
            }
            
            .hero h1 {
                font-size: 1.8rem;
            }
            
            .hero p {
                font-size: 1rem;
            }
            
            .menu h2 {
                font-size: 1.6rem;
            }
            
            .menu-items {
                grid-template-columns: 1fr;
            }
        }

        /* Print styles */
        @media print {
            .btn, nav, footer {
                display: none;
            }
            
            body {
                color: black;
                background: white;
            }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--secondary);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #2a93d5;
        }

        /* ===== SEARCH AND FILTER SYSTEM ===== */
        .search-filter-container {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin: 0 auto 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            max-width: 1200px;
        }

        .search-section {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .search-input-container {
            flex: 1;
            min-width: 300px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(56, 182, 255, 0.2);
            outline: none;
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
            font-size: 1.2rem;
        }

        .filter-toggle {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(56, 182, 255, 0.3);
        }

        .filter-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(56, 182, 255, 0.4);
        }

        .filter-toggle i {
            transition: transform 0.3s ease;
        }

        .filter-toggle.active i {
            transform: rotate(180deg);
        }

        .filter-section {
            display: none;
            padding-top: 25px;
            border-top: 1px solid #e1e5e9;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .filter-section.active {
            display: block;
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-label {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .filter-select {
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
            transition: all 0.3s ease;
        }

        .filter-select:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 0 2px rgba(56, 182, 255, 0.2);
        }

        .filter-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-apply {
            background: var(--secondary);
            color: white;
            box-shadow: 0 4px 15px rgba(56, 182, 255, 0.3);
        }

        .filter-apply:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(56, 182, 255, 0.4);
        }

        .filter-reset {
            background: transparent;
            color: #666;
            border: 2px solid #e1e5e9;
        }

        .filter-reset:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .results-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px 0;
            border-bottom: 1px solid #e1e5e9;
        }

        .results-count {
            font-weight: 600;
            color: var(--primary);
        }

        .sort-options {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sort-label {
            color: #666;
            font-size: 0.9rem;
        }

        .sort-select {
            padding: 8px 12px;
            border: 1px solid #e1e5e9;
            border-radius: 6px;
            font-size: 0.9rem;
            background: white;
        }

        .active-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .active-filter {
            background: var(--secondary);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .active-filter .remove-filter {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 0.8rem;
            padding: 0;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .no-results i {
            font-size: 4rem;
            color: #ddd;
            margin-bottom: 20px;
        }

        .no-results h3 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: #555;
        }

        .no-results p {
            font-size: 1.1rem;
            margin-bottom: 25px;
        }

        /* Mobile styles for search and filter */
        @media (max-width: 768px) {
            .search-section {
                flex-direction: column;
            }

            .search-input-container {
                min-width: 100%;
            }

            .filter-grid {
                grid-template-columns: 1fr;
            }

            .filter-actions {
                justify-content: stretch;
            }

            .filter-btn {
                flex: 1;
            }

            .results-info {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }

            .sort-options {
                width: 100%;
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>
    <!-- ===== ACCESSIBILITY: SKIP TO CONTENT ===== -->
    <a href="#main-content" class="skip-to-content" aria-label="Skip to main content">Skip to Content</a>

    <header role="banner">
        <div class="header-content">
            <div class="logo-container">
                <div class="logo">
                    <div class="logo-icon" aria-hidden="true">
                        <img src="munchies-logo.png" alt="Munchies Logo">
                    </div>
                    <span>Munchies & Shukisha</span>
                </div>
                <div class="brand-names" aria-label="Tagline: Every bite's a party">
                    <span>Every bite's a party</span>
                </div>
            </div>
            <nav role="navigation" aria-label="Main navigation">
                <ul>
                    <li><a href="#" aria-current="page"><i class="fas fa-home" aria-hidden="true"></i> <span class="nav-text">Home</span></a></li>
                    <li><a href="#vendors"><i class="fas fa-utensils" aria-hidden="true"></i> <span class="nav-text">Vendors</span></a></li>
                    <li><a href="#features"><i class="fas fa-star" aria-hidden="true"></i> <span class="nav-text">Features</span></a></li>
                    <li id="authItem"><a href="#" id="authLink"><i class="fas fa-user" aria-hidden="true"></i> <span class="nav-text">Login</span></a></li>
                    <li id="vendorDashboardLink" style="display: none;"><a href="vendor-dashboard.html"><i class="fas fa-store" aria-hidden="true"></i> <span class="nav-text">My Store</span></a></li>
                    <li><a href="#"><i class="fas fa-phone" aria-hidden="true"></i> <span class="nav-text">Contact</span></a></li>
                </ul>
            </nav>
        </div>
    </header>
    
    <main id="main-content" role="main">
        <!-- Home page content (default view) -->
        <div id="home-page">
            <section class="hero" aria-label="Welcome to Munchies & Shukisha">
                <div class="hero-content">
                    <h1>Kenya's Local Chef Marketplace</h1>
                    <p>Order from home chefs & restaurants near you</p>
                    <div class="btn-container">
                        <a href="#vendors" class="btn" aria-label="Browse our food vendors">Browse Vendors</a>
                        <a href="#" class="btn btn-secondary" onclick="showSignupModal()" aria-label="Sign up to sell your food">Sell Your Food</a>
                    </div>
                </div>
            </section>
            
            <section class="features" id="features" aria-labelledby="features-heading">
                <h2 id="features-heading">Why Choose Munchies & Shukisha?</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon" aria-hidden="true">
                            <i class="fas fa-utensils"></i>
                        </div>
                        <h3>Authentic Local Cuisine</h3>
                        <p>Discover the best home-cooked meals from talented chefs in your neighborhood, offering authentic flavors you can't find anywhere else.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon" aria-hidden="true">
                            <i class="fas fa-shipping-fast"></i>
                        </div>
                        <h3>Fast Delivery</h3>
                        <p>Get your favorite meals delivered to your doorstep in under 30 minutes with our efficient delivery network.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon" aria-hidden="true">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h3>Quality Assured</h3>
                        <p>All our vendors are verified and regularly inspected to ensure the highest standards of food safety and quality.</p>
                    </div>
                </div>
            </section>
            
            <section class="menu" id="vendors" aria-labelledby="vendors-heading">
                <div class="menu-header">
                    <h2 id="vendors-heading">Featured Vendors</h2>
                    <p>Discover amazing home chefs and restaurants in your area</p>
                </div>

                <!-- Search and Filter System -->
                <div class="search-filter-container">
                    <div class="search-section">
                        <div class="search-input-container">
                            <input type="text" id="searchInput" class="search-input" placeholder="Search for vendors, dishes, or cuisines..." aria-label="Search for vendors, dishes, or cuisines">
                            <i class="fas fa-search search-icon" aria-hidden="true"></i>
                        </div>
                        <button class="filter-toggle" id="filterToggle" aria-expanded="false" aria-controls="filterSection">
                            <i class="fas fa-filter" aria-hidden="true"></i>
                            Filters
                        </button>
                    </div>

                    <div class="filter-section" id="filterSection" role="region" aria-labelledby="filterToggle">
                        <div class="filter-grid">
                            <div class="filter-group">
                                <label class="filter-label" for="cuisineFilter">Cuisine Type</label>
                                <select id="cuisineFilter" class="filter-select">
                                    <option value="">All Cuisines</option>
                                    <option value="kenyan">Kenyan</option>
                                    <option value="african">African</option>
                                    <option value="indian">Indian</option>
                                    <option value="chinese">Chinese</option>
                                    <option value="italian">Italian</option>
                                    <option value="american">American</option>
                                    <option value="mexican">Mexican</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label" for="priceFilter">Price Range</label>
                                <select id="priceFilter" class="filter-select">
                                    <option value="">Any Price</option>
                                    <option value="budget">Budget (Under KSh 300)</option>
                                    <option value="moderate">Moderate (KSh 300 - 700)</option>
                                    <option value="premium">Premium (Over KSh 700)</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label" for="ratingFilter">Minimum Rating</label>
                                <select id="ratingFilter" class="filter-select">
                                    <option value="">Any Rating</option>
                                    <option value="4.5">4.5+ Stars</option>
                                    <option value="4.0">4.0+ Stars</option>
                                    <option value="3.5">3.5+ Stars</option>
                                    <option value="3.0">3.0+ Stars</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label" for="deliveryFilter">Delivery Time</label>
                                <select id="deliveryFilter" class="filter-select">
                                    <option value="">Any Time</option>
                                    <option value="fast">Fast (Under 30 min)</option>
                                    <option value="standard">Standard (30-45 min)</option>
                                    <option value="extended">Extended (45+ min)</option>
                                </select>
                            </div>
                        </div>
                        <div class="filter-actions">
                            <button class="filter-btn filter-apply" id="applyFilters" aria-label="Apply filters">Apply Filters</button>
                            <button class="filter-btn filter-reset" id="resetFilters" aria-label="Reset all filters">Reset</button>
                        </div>
                    </div>

                    <div class="results-info">
                        <div class="results-count" id="resultsCount" aria-live="polite">Showing all vendors</div>
                        <div class="sort-options">
                            <span class="sort-label">Sort by:</span>
                            <select id="sortOptions" class="sort-select" aria-label="Sort vendors by">
                                <option value="name">Name (A-Z)</option>
                                <option value="rating">Highest Rated</option>
                                <option value="delivery">Fastest Delivery</option>
                                <option value="price-low">Price (Low to High)</option>
                                <option value="price-high">Price (High to Low)</option>
                            </select>
                        </div>
                    </div>

                    <div class="active-filters" id="activeFilters" aria-live="polite">
                        <!-- Active filters will be displayed here -->
                    </div>
                </div>

                <div class="menu-items" id="vendors-container">
                    <!-- Vendor items will be dynamically populated here -->
                    <div class="empty-state">
                        <i class="fas fa-utensils" aria-hidden="true"></i>
                        <h3>No Vendors Yet</h3>
                        <p>Be the first to sign up as a vendor and showcase your culinary creations!</p>
                        <button class="btn" onclick="showSignupModal()" style="margin-top: 20px;" aria-label="Become a food vendor">Become a Vendor</button>
                    </div>
                </div>
            </section>
        </div>

        <!-- Restaurant Detail Page (hidden by default) -->
        <div id="restaurant-detail-page" class="restaurant-detail" style="display: none;" aria-hidden="true">
            <!-- Content will be dynamically populated by JavaScript -->
        </div>
    </main>

    <!-- Protected Content Overlay -->
    <div class="protected-overlay" id="protectedOverlay" aria-hidden="true">
        <div class="protected-content">
            <h2>Please Sign In</h2>
            <p>You need to be logged in to make purchases</p>
            <button onclick="showLoginModal()" class="btn" aria-label="Open login modal">Login</button>
            <p>Don't have an account? <a href="#" onclick="showSignupModal()" aria-label="Open signup modal">Sign up</a></p>
        </div>
    </div>

    <!-- Shopping Cart -->
    <div class="cart-icon" onclick="showCart()" role="button" aria-label="View shopping cart" tabindex="0">
        <i class="fas fa-shopping-cart" aria-hidden="true"></i>
        <div class="cart-count" id="cartCount" aria-live="polite">0</div>
    </div>

    <!-- Social Icons -->
    <div class="social-icons" aria-label="Social media links">
        <a href="#" title="Facebook" aria-label="Visit our Facebook page"><i class="fab fa-facebook-f" aria-hidden="true"></i></a>
        <a href="#" title="Instagram" aria-label="Visit our Instagram page"><i class="fab fa-instagram" aria-hidden="true"></i></a>
        <a href="#" title="Twitter" aria-label="Visit our Twitter page"><i class="fab fa-twitter" aria-hidden="true"></i></a>
        <a href="#" title="TikTok" aria-label="Visit our TikTok page"><i class="fab fa-tiktok" aria-hidden="true"></i></a>
    </div>
    
    <footer role="contentinfo">
        <p>&copy; <span id="currentYear">2023</span> Munchies & Shukisha. All rights reserved.</p>
    </footer>

    <!-- Auth Modals -->
    <div class="overlay" id="overlay" aria-hidden="true"></div>
    
    <div class="auth-modal" id="loginModal" aria-hidden="true" role="dialog" aria-labelledby="login-heading">
        <span class="close" onclick="closeModals()" aria-label="Close login modal"></span>
        <div class="auth-header">
            <div class="auth-icon" aria-hidden="true">
                <i class="fas fa-user"></i>
            </div>
            <h2 id="login-heading">Welcome Back</h2>
            <p>Sign in to your account to continue</p>
        </div>
        
        <div class="form-input-group">
            <input type="email" id="loginEmail" placeholder=" " autocomplete="email" aria-required="true" aria-describedby="loginEmailError">
            <label for="loginEmail">Email Address</label>
            <div class="form-error" id="loginEmailError" role="alert">Please enter a valid email address</div>
        </div>
        
        <div class="form-input-group">
            <input type="password" id="loginPassword" placeholder=" " autocomplete="current-password" aria-required="true" aria-describedby="loginPasswordError">
            <label for="loginPassword">Password</label>
            <span class="password-toggle" id="loginPasswordToggle" role="button" aria-label="Toggle password visibility">
                <i class="fas fa-eye"></i>
            </span>
            <div class="form-error" id="loginPasswordError" role="alert">Please enter your password</div>
        </div>
        
        <div class="remember-forgot">
            <div class="remember-me">
                <input type="checkbox" id="rememberMe">
                <label for="rememberMe">Remember me</label>
            </div>
            <a href="#" class="forgot-password" onclick="showForgotPassword()" aria-label="Reset your password">Forgot password?</a>
        </div>
        
        <button id="loginButton" onclick="login()" aria-label="Sign in to your account">Login</button>
        
        <div class="divider">
            <span>Or continue with</span>
        </div>
        
        <div class="social-login">
            <button class="social-btn google" onclick="signInWithGoogle()" aria-label="Sign in with Google">
                <i class="fab fa-google"></i>
                Google
            </button>
            <button class="social-btn facebook" onclick="signInWithFacebook()" aria-label="Sign in with Facebook">
                <i class="fab fa-facebook-f"></i>
                Facebook
            </button>
        </div>
        
        <div class="auth-footer">
            Don't have an account? <a onclick="switchToSignup()" aria-label="Switch to signup form">Sign up</a>
        </div>
    </div>
    
    <div class="auth-modal" id="signupModal" aria-hidden="true" role="dialog" aria-labelledby="signup-heading">
        <span class="close" onclick="closeModals()" aria-label="Close signup modal"></span>
        <div class="auth-header">
            <div class="auth-icon" aria-hidden="true">
                <i class="fas fa-user-plus"></i>
            </div>
            <h2 id="signup-heading">Create Account</h2>
            <p>Join our community of food lovers</p>
        </div>
        
        <div class="form-input-group">
            <input type="text" id="signupName" placeholder=" " autocomplete="name" aria-required="true" aria-describedby="signupNameError">
            <label for="signupName">Full Name</label>
            <div class="form-error" id="signupNameError" role="alert">Please enter your full name</div>
        </div>
        
        <div class="form-input-group">
            <input type="email" id="signupEmail" placeholder=" " autocomplete="email" aria-required="true" aria-describedby="signupEmailError">
            <label for="signupEmail">Email Address</label>
            <div class="form-error" id="signupEmailError" role="alert">Please enter a valid email address</div>
        </div>
        
        <div class="form-input-group">
            <input type="password" id="signupPassword" placeholder=" " autocomplete="new-password" aria-required="true" aria-describedby="signupPasswordError">
            <label for="signupPassword">Password</label>
            <span class="password-toggle" id="signupPasswordToggle" role="button" aria-label="Toggle password visibility">
                <i class="fas fa-eye"></i>
            </span>
            <div class="form-error" id="signupPasswordError" role="alert">Password must be at least 8 characters</div>
        </div>
        
        <div class="form-input-group">
            <select id="userType" onchange="toggleVendorFields()" aria-required="true" aria-describedby="userTypeError">
                <option value="buyer">I'm a Buyer</option>
                <option value="seller">I'm a Seller</option>
            </select>
            <div class="form-error" id="userTypeError" role="alert">Please select an account type</div>
        </div>
        
        <!-- Vendor-specific fields (hidden by default) -->
        <div id="vendorFields" aria-hidden="true">
            <div class="form-input-group">
                <input type="text" id="businessName" placeholder=" " autocomplete="organization" aria-required="true" aria-describedby="businessNameError">
                <label for="businessName">Business Name</label>
                <div class="form-error" id="businessNameError" role="alert">Please enter your business name</div>
            </div>
            
            <div class="form-input-group">
                <input type="text" id="businessLocation" placeholder=" " autocomplete="address-level2" aria-required="true" aria-describedby="businessLocationError">
                <label for="businessLocation">Business Location</label>
                <div class="form-error" id="businessLocationError" role="alert">Please enter your business location</div>
            </div>
            
            <div class="form-input-group">
                <input type="text" id="foodHandlersCert" placeholder=" " aria-required="true" aria-describedby="foodHandlersCertError">
                <label for="foodHandlersCert">Food Handler's Certificate No.</label>
                <div class="form-error" id="foodHandlersCertError" role="alert">Please enter your certificate number</div>
            </div>
            
            <div class="form-input-group">
                <input type="text" id="kraPin" placeholder=" " aria-required="true" aria-describedby="kraPinError">
                <label for="kraPin">KRA PIN</label>
                <div class="form-error" id="kraPinError" role="alert">Please enter your KRA PIN</div>
            </div>
            
            <div class="form-input-group">
                <textarea id="description" placeholder=" " rows="3" aria-required="true" aria-describedby="descriptionError"></textarea>
                <label for="description">Describe your food business</label>
                <div class="form-error" id="descriptionError" role="alert">Please describe your business</div>
            </div>
            
            <div class="file-upload-container">
                <label class="file-upload-label">Business Logo</label>
                <div class="file-upload-box" onclick="document.getElementById('businessLogo').click()" role="button" aria-label="Upload business logo">
                    <i class="fas fa-cloud-upload-alt" aria-hidden="true"></i>
                    <p>Click to upload or drag and drop</p>
                    <span>PNG, JPG, GIF up to 10MB</span>
                    <input type="file" id="businessLogo" accept="image/*" onchange="previewImage(this, 'logoPreview')">
                </div>
                <div class="image-preview" id="logoPreview"></div>
            </div>
            
            <div class="file-upload-container">
                <label class="file-upload-label">Business Photos</label>
                <div class="file-upload-box" onclick="document.getElementById('businessPhotos').click()" role="button" aria-label="Upload business photos">
                    <i class="fas fa-cloud-upload-alt" aria-hidden="true"></i>
                    <p>Click to upload or drag and drop</p>
                    <span>PNG, JPG, GIF up to 10MB</span>
                    <input type="file" id="businessPhotos" accept="image/*" multiple onchange="previewImage(this, 'photosPreview')">
                </div>
                <div class="image-preview" id="photosPreview"></div>
            </div>
            
            <div class="form-input-group">
                <select id="deliveryMethod" aria-required="true" aria-describedby="deliveryMethodError">
                    <option value="">Delivery Method</option>
                    <option value="self">Self-Delivery</option>
                    <option value="platform">Platform Delivery</option>
                    <option value="both">Both</option>
                </select>
                <div class="form-error" id="deliveryMethodError" role="alert">Please select a delivery method</div>
            </div>
            
            <div class="file-upload-container">
                <label class="file-upload-label">Business Permit</label>
                <div class="file-upload-box" onclick="document.getElementById('businessPermit').click()" role="button" aria-label="Upload business permit">
                    <i class="fas fa-cloud-upload-alt" aria-hidden="true"></i>
                    <p>Click to upload your business permit</p>
                    <span>Image or PDF up to 10MB</span>
                    <input type="file" id="businessPermit" accept="image/*,.pdf">
                </div>
            </div>
        </div>
        
        <div class="remember-me">
            <input type="checkbox" id="termsAgree" aria-required="true">
            <label for="termsAgree">I agree to the <a href="#" style="color: var(--secondary);">Terms of Service</a> and <a href="#" style="color: var(--secondary);">Privacy Policy</a></label>
        </div>
        
        <button id="signupButton" onclick="signup()" aria-label="Create your account">Create Account</button>
        
        <div class="divider">
            <span>Or sign up with</span>
        </div>
        
        <div class="social-login">
            <button class="social-btn google" onclick="signInWithGoogle()" aria-label="Sign up with Google">
                <i class="fab fa-google"></i>
                Google
            </button>
            <button class="social-btn facebook" onclick="signInWithFacebook()" aria-label="Sign up with Facebook">
                <i class="fab fa-facebook-f"></i>
                Facebook
            </button>
        </div>
        
        <div class="auth-footer">
            Already have an account? <a onclick="switchToLogin()" aria-label="Switch to login form">Login</a>
        </div>
    </div>

    <!-- Forgot Password Modal -->
    <div class="auth-modal" id="forgotPasswordModal" aria-hidden="true" role="dialog" aria-labelledby="forgot-password-heading">
        <span class="close" onclick="closeModals()" aria-label="Close forgot password modal"></span>
        <div class="auth-header">
            <div class="auth-icon" aria-hidden="true">
                <i class="fas fa-key"></i>
            </div>
            <h2 id="forgot-password-heading">Reset Password</h2>
            <p>Enter your email to receive a reset link</p>
        </div>
        
        <div class="form-input-group">
            <input type="email" id="resetEmail" placeholder=" " autocomplete="email" aria-required="true" aria-describedby="resetEmailError">
            <label for="resetEmail">Email Address</label>
            <div class="form-error" id="resetEmailError" role="alert">Please enter a valid email address</div>
        </div>
        
        <button id="resetPasswordButton" onclick="resetPassword()" aria-label="Send password reset instructions">Send Reset Link</button>
        
        <div class="auth-footer">
            Remember your password? <a onclick="switchToLogin()" aria-label="Switch to login form">Login</a>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div class="checkout-modal" id="checkoutModal" aria-hidden="true" role="dialog" aria-labelledby="checkout-heading">
        <span class="close" onclick="closeCheckout()" aria-label="Close checkout modal"></span>
        <h2 id="checkout-heading">Checkout</h2>
        <div class="checkout-items" id="checkoutItems">
            <!-- Cart items will be populated here -->
        </div>
        <div class="checkout-total">
            <span>Total:</span>
            <span id="checkoutTotal">KSh 0</span>
        </div>
        
        <div class="payment-form">
            <h3>Payment Method</h3>
            <div class="payment-options">
                <div class="payment-option" onclick="selectPayment('mpesa')" role="button" aria-label="Pay with M-Pesa" tabindex="0">
                    <i class="fas fa-mobile-alt" aria-hidden="true"></i>
                    <span>M-Pesa</span>
                </div>
                <div class="payment-option" onclick="selectPayment('card')" role="button" aria-label="Pay with card" tabindex="0">
                    <i class="fas fa-credit-card" aria-hidden="true"></i>
                    <span>Card</span>
                </div>
                <div class="payment-option" onclick="selectPayment('cash')" role="button" aria-label="Pay with cash" tabindex="0">
                    <i class="fas fa-money-bill-wave" aria-hidden="true"></i>
                    <span>Cash</span>
                </div>
            </div>
            
            <div id="mpesaForm" style="display: none;">
                <div class="form-group">
                    <input type="tel" placeholder="Phone Number" id="mpesaPhone" aria-label="M-Pesa phone number">
                </div>
                <button onclick="payWithMpesa()" class="btn" aria-label="Complete payment with M-Pesa">Pay with M-Pesa</button>
            </div>
            
            <div id="cardForm" style="display: none;">
                <div class="form-group">
                    <input type="text" placeholder="Card Number" id="cardNumber" aria-label="Card number">
                </div>
                <div style="display: flex; gap: 10px;">
                    <div class="form-group" style="flex: 1;">
                        <input type="text" placeholder="MM/YY" id="cardExpiry" aria-label="Card expiry date">
                    </div>
                    <div class="form-group" style="flex: 1;">
                        <input type="text" placeholder="CVV" id="cardCvv" aria-label="Card security code">
                    </div>
                </div>
                <button onclick="payWithCard()" class="btn" aria-label="Complete payment with card">Pay with Card</button>
            </div>
            
            <div id="cashForm" style="display: none;">
                <p>Pay with cash when your order is delivered</p>
                <button onclick="placeOrder()" class="btn" aria-label="Place order with cash payment">Place Order</button>
            </div>
        </div>
    </div>

    <script>
        // Set current year in footer
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // DOM Elements
        const authLink = document.getElementById('authLink');
        const authItem = document.getElementById('authItem');
        const overlay = document.getElementById('overlay');
        const loginModal = document.getElementById('loginModal');
        const signupModal = document.getElementById('signupModal');
        const forgotPasswordModal = document.getElementById('forgotPasswordModal');
        const protectedOverlay = document.getElementById('protectedOverlay');
        const cartCount = document.getElementById('cartCount');
        const homePage = document.getElementById('home-page');
        const restaurantDetailPage = document.getElementById('restaurant-detail-page');
        const checkoutModal = document.getElementById('checkoutModal');
        const checkoutItems = document.getElementById('checkoutItems');
        const checkoutTotal = document.getElementById('checkoutTotal');
        const vendorsContainer = document.getElementById('vendors-container');
        const vendorDashboardLink = document.getElementById('vendorDashboardLink');

        // Search and Filter Elements
        const searchInput = document.getElementById('searchInput');
        const filterToggle = document.getElementById('filterToggle');
        const filterSection = document.getElementById('filterSection');
        const cuisineFilter = document.getElementById('cuisineFilter');
        const priceFilter = document.getElementById('priceFilter');
        const ratingFilter = document.getElementById('ratingFilter');
        const deliveryFilter = document.getElementById('deliveryFilter');
        const applyFilters = document.getElementById('applyFilters');
        const resetFilters = document.getElementById('resetFilters');
        const resultsCount = document.getElementById('resultsCount');
        const sortOptions = document.getElementById('sortOptions');
        const activeFilters = document.getElementById('activeFilters');

        // Cart state
        let cart = [];
        let isLoggedIn = false;
        let selectedPaymentMethod = '';
        let currentUser = null;
        let vendors = [];

        // Search and Filter state
        let currentFilters = {
            search: '',
            cuisine: '',
            price: '',
            rating: '',
            delivery: ''
        };

        // Initialize the page
        function init() {
            loadCart();
            loadVendors();
            checkBackgroundColor();
            setupHeaderScroll();
            setupAuthEnhancements();
            setupSearchAndFilter();
            preloadCriticalImages();
            
            // ===== ACCESSIBILITY: ENHANCE KEYBOARD NAVIGATION =====
            enhanceKeyboardNavigation();
        }

        // ===== SEARCH AND FILTER SYSTEM =====
        function setupSearchAndFilter() {
            // Toggle filter section
            filterToggle.addEventListener('click', function() {
                filterSection.classList.toggle('active');
                filterToggle.classList.toggle('active');
                filterToggle.setAttribute('aria-expanded', filterSection.classList.contains('active'));
            });

            // Apply filters
            applyFilters.addEventListener('click', applySearchAndFilter);

            // Reset filters
            resetFilters.addEventListener('click', resetSearchAndFilter);

            // Search input with debounce
            searchInput.addEventListener('input', debounce(function() {
                currentFilters.search = this.value;
                applySearchAndFilter();
            }, 300));

            // Sort options
            sortOptions.addEventListener('change', applySearchAndFilter);

            // Filter changes
            cuisineFilter.addEventListener('change', function() {
                currentFilters.cuisine = this.value;
                updateActiveFilters();
            });

            priceFilter.addEventListener('change', function() {
                currentFilters.price = this.value;
                updateActiveFilters();
            });

            ratingFilter.addEventListener('change', function() {
                currentFilters.rating = this.value;
                updateActiveFilters();
            });

            deliveryFilter.addEventListener('change', function() {
                currentFilters.delivery = this.value;
                updateActiveFilters();
            });
        }

        function applySearchAndFilter() {
            const filteredVendors = filterVendors();
            const sortedVendors = sortVendors(filteredVendors);
            renderFilteredVendors(sortedVendors);
            updateResultsCount(sortedVendors.length);
            updateActiveFilters();
        }

        function filterVendors() {
            return vendors.filter(vendor => {
                // Search filter
                if (currentFilters.search) {
                    const searchTerm = currentFilters.search.toLowerCase();
                    const matchesSearch = 
                        vendor.businessName.toLowerCase().includes(searchTerm) ||
                        vendor.description.toLowerCase().includes(searchTerm) ||
                        (vendor.cuisineType && vendor.cuisineType.toLowerCase().includes(searchTerm));
                    
                    if (!matchesSearch) return false;
                }

                // Cuisine filter
                if (currentFilters.cuisine && vendor.cuisineType !== currentFilters.cuisine) {
                    return false;
                }

                // Price filter
                if (currentFilters.price) {
                    const priceRange = getPriceRange(vendor);
                    if (priceRange !== currentFilters.price) return false;
                }

                // Rating filter
                if (currentFilters.rating) {
                    const minRating = parseFloat(currentFilters.rating);
                    if (vendor.rating < minRating) return false;
                }

                // Delivery filter
                if (currentFilters.delivery) {
                    const deliveryTime = getDeliveryTime(vendor);
                    if (deliveryTime !== currentFilters.delivery) return false;
                }

                return true;
            });
        }

        function sortVendors(vendors) {
            const sortBy = sortOptions.value;
            
            return [...vendors].sort((a, b) => {
                switch (sortBy) {
                    case 'name':
                        return a.businessName.localeCompare(b.businessName);
                    case 'rating':
                        return (b.rating || 0) - (a.rating || 0);
                    case 'delivery':
                        return (a.deliveryTime || 45) - (b.deliveryTime || 45);
                    case 'price-low':
                        return (a.minPrice || 0) - (b.minPrice || 0);
                    case 'price-high':
                        return (b.minPrice || 0) - (a.minPrice || 0);
                    default:
                        return 0;
                }
            });
        }

        function renderFilteredVendors(filteredVendors) {
            if (filteredVendors.length === 0) {
                vendorsContainer.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-search" aria-hidden="true"></i>
                        <h3>No vendors found</h3>
                        <p>Try adjusting your search or filters to find what you're looking for.</p>
                        <button class="btn" onclick="resetSearchAndFilter()" style="margin-top: 20px;" aria-label="Reset all filters">Reset Filters</button>
                    </div>
                `;
                return;
            }

            let vendorsHTML = '';
            
            filteredVendors.forEach(vendor => {
                vendorsHTML += `
                    <div class="menu-item" onclick="showRestaurantDetail('${vendor.id}')" role="button" tabindex="0" aria-label="View ${vendor.businessName} details">
                        <button class="add-to-cart" onclick="event.stopPropagation(); addToCart('${vendor.businessName} Sample Dish', 499)" aria-label="Add sample dish from ${vendor.businessName} to cart">
                            <i class="fas fa-plus" aria-hidden="true"></i>
                        </button>
                        <img src="${vendor.logo || 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80'}" alt="${vendor.businessName}" class="menu-item-img" loading="lazy">
                        <div class="menu-item-content">
                            <span class="vendor-badge">${vendor.businessType || 'Food Vendor'}</span>
                            <h3>${vendor.businessName}</h3>
                            <p>${vendor.description || 'Delicious food made with love and tradition.'}</p>
                            <div class="rating" aria-label="Rating: ${vendor.rating || 4} out of 5 stars">
                                ${generateStarRating(vendor.rating || 4)}
                                <span>(${vendor.reviewCount || 0} reviews)</span>
                            </div>
                            <p class="price">KSh ${vendor.minPrice || 499}+</p>
                            <button class="btn" onclick="event.stopPropagation(); addToCart('${vendor.businessName} Sample Dish', ${vendor.minPrice || 499})" aria-label="Add sample dish from ${vendor.businessName} to cart">Add to Cart</button>
                        </div>
                    </div>
                `;
            });
            
            vendorsContainer.innerHTML = vendorsHTML;
        }

        function generateStarRating(rating) {
            let stars = '';
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            
            for (let i = 0; i < fullStars; i++) {
                stars += '<i class="fas fa-star" aria-hidden="true"></i>';
            }
            
            if (hasHalfStar) {
                stars += '<i class="fas fa-star-half-alt" aria-hidden="true"></i>';
            }
            
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            for (let i = 0; i < emptyStars; i++) {
                stars += '<i class="far fa-star" aria-hidden="true"></i>';
            }
            
            return stars;
        }

        function getPriceRange(vendor) {
            const price = vendor.minPrice || 499;
            if (price < 300) return 'budget';
            if (price <= 700) return 'moderate';
            return 'premium';
        }

        function getDeliveryTime(vendor) {
            const time = vendor.deliveryTime || 45;
            if (time < 30) return 'fast';
            if (time <= 45) return 'standard';
            return 'extended';
        }

        function updateResultsCount(count) {
            const totalVendors = vendors.length;
            if (count === totalVendors) {
                resultsCount.textContent = `Showing all ${count} vendors`;
            } else {
                resultsCount.textContent = `Showing ${count} of ${totalVendors} vendors`;
            }
        }

        function updateActiveFilters() {
            activeFilters.innerHTML = '';
            
            Object.entries(currentFilters).forEach(([key, value]) => {
                if (value) {
                    const filterName = getFilterDisplayName(key, value);
                    const activeFilter = document.createElement('div');
                    activeFilter.className = 'active-filter';
                    activeFilter.innerHTML = `
                        ${filterName}
                        <button class="remove-filter" onclick="removeFilter('${key}')" aria-label="Remove ${filterName} filter">
                            <i class="fas fa-times"></i>
                        </button>
                    `;
                    activeFilters.appendChild(activeFilter);
                }
            });
        }

        function getFilterDisplayName(filterKey, filterValue) {
            const filterNames = {
                search: `Search: "${filterValue}"`,
                cuisine: `Cuisine: ${filterValue.charAt(0).toUpperCase() + filterValue.slice(1)}`,
                price: `Price: ${getPriceDisplayName(filterValue)}`,
                rating: `Rating: ${filterValue}+ stars`,
                delivery: `Delivery: ${getDeliveryDisplayName(filterValue)}`
            };
            
            return filterNames[filterKey] || `${filterKey}: ${filterValue}`;
        }

        function getPriceDisplayName(priceValue) {
            const priceNames = {
                'budget': 'Budget',
                'moderate': 'Moderate',
                'premium': 'Premium'
            };
            return priceNames[priceValue] || priceValue;
        }

        function getDeliveryDisplayName(deliveryValue) {
            const deliveryNames = {
                'fast': 'Fast (<30 min)',
                'standard': 'Standard (30-45 min)',
                'extended': 'Extended (>45 min)'
            };
            return deliveryNames[deliveryValue] || deliveryValue;
        }

        function removeFilter(filterKey) {
            currentFilters[filterKey] = '';
            
            // Reset the corresponding form element
            switch (filterKey) {
                case 'search':
                    searchInput.value = '';
                    break;
                case 'cuisine':
                    cuisineFilter.value = '';
                    break;
                case 'price':
                    priceFilter.value = '';
                    break;
                case 'rating':
                    ratingFilter.value = '';
                    break;
                case 'delivery':
                    deliveryFilter.value = '';
                    break;
            }
            
            applySearchAndFilter();
        }

        function resetSearchAndFilter() {
            // Reset all filters
            currentFilters = {
                search: '',
                cuisine: '',
                price: '',
                rating: '',
                delivery: ''
            };
            
            // Reset form elements
            searchInput.value = '';
            cuisineFilter.value = '';
            priceFilter.value = '';
            ratingFilter.value = '';
            deliveryFilter.value = '';
            sortOptions.value = 'name';
            
            // Reapply filters (which will show all vendors)
            applySearchAndFilter();
        }

        // ===== ACCESSIBILITY: ENHANCE KEYBOARD NAVIGATION =====
        function enhanceKeyboardNavigation() {
            // Add keyboard navigation to modal triggers
            document.addEventListener('keydown', function(e) {
                // Close modals with Escape key
                if (e.key === 'Escape') {
                    closeModals();
                    protectedOverlay.style.display = 'none';
                    closeCheckout();
                    
                    const toast = document.querySelector('.toast');
                    if (toast) toast.remove();
                    
                    // Close cart modal if open
                    const cartModal = document.querySelector('.auth-modal:not(#loginModal):not(#signupModal):not(#checkoutModal)');
                    const cartOverlay = document.querySelector('.overlay:not(#overlay)');
                    
                    if (cartModal) cartModal.remove();
                    if (cartOverlay) cartOverlay.remove();
                }
                
                // Navigate modals with arrow keys
                if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {
                    const activeElement = document.activeElement;
                    const focusableElements = getFocusableElements(activeElement.closest('.auth-modal, .checkout-modal'));
                    
                    if (focusableElements.length > 0) {
                        e.preventDefault();
                        const currentIndex = focusableElements.indexOf(activeElement);
                        let nextIndex;
                        
                        if (e.key === 'ArrowDown') {
                            nextIndex = currentIndex < focusableElements.length - 1 ? currentIndex + 1 : 0;
                        } else {
                            nextIndex = currentIndex > 0 ? currentIndex - 1 : focusableElements.length - 1;
                        }
                        
                        focusableElements[nextIndex].focus();
                    }
                }
            });
        }

        function getFocusableElements(container) {
            if (!container) return [];
            return Array.from(container.querySelectorAll(
                'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
            )).filter(el => !el.disabled && el.offsetParent !== null);
        }

        // Setup header scroll behavior
        function setupHeaderScroll() {
            const header = document.querySelector('header');
            const headerContent = document.querySelector('.header-content');
            
            window.addEventListener('scroll', debounce(() => {
                if (window.scrollY > 100) {
                    header.classList.add('scrolled');
                    headerContent.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                    headerContent.classList.remove('scrolled');
                }
            }, 10));
        }

        // Setup auth enhancements
        function setupAuthEnhancements() {
            // Password toggle functionality
            setupPasswordToggle('loginPassword', 'loginPasswordToggle');
            setupPasswordToggle('signupPassword', 'signupPasswordToggle');
            
            // Form validation
            setupFormValidation();
        }

        // Setup password toggle
        function setupPasswordToggle(passwordFieldId, toggleButtonId) {
            const passwordField = document.getElementById(passwordFieldId);
            const toggleButton = document.getElementById(toggleButtonId);
            
            if (passwordField && toggleButton) {
                toggleButton.addEventListener('click', function() {
                    if (passwordField.type === 'password') {
                        passwordField.type = 'text';
                        toggleButton.innerHTML = '<i class="fas fa-eye-slash"></i>';
                        toggleButton.setAttribute('aria-label', 'Hide password');
                    } else {
                        passwordField.type = 'password';
                        toggleButton.innerHTML = '<i class="fas fa-eye"></i>';
                        toggleButton.setAttribute('aria-label', 'Show password');
                    }
                });

                // Add keyboard support for password toggle
                toggleButton.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        toggleButton.click();
                    }
                });
            }
        }

        // Setup form validation
        function setupFormValidation() {
            // Login form validation
            const loginEmail = document.getElementById('loginEmail');
            const loginPassword = document.getElementById('loginPassword');
            
            if (loginEmail) {
                loginEmail.addEventListener('blur', function() {
                    validateEmail(this, 'loginEmailError');
                });
            }
            
            if (loginPassword) {
                loginPassword.addEventListener('blur', function() {
                    validateField(this, 'loginPasswordError', 'Please enter your password');
                });
            }
            
            // Signup form validation
            const signupName = document.getElementById('signupName');
            const signupEmail = document.getElementById('signupEmail');
            const signupPassword = document.getElementById('signupPassword');
            
            if (signupName) {
                signupName.addEventListener('blur', function() {
                    validateField(this, 'signupNameError', 'Please enter your full name');
                });
            }
            
            if (signupEmail) {
                signupEmail.addEventListener('blur', function() {
                    validateEmail(this, 'signupEmailError');
                });
            }
            
            if (signupPassword) {
                signupPassword.addEventListener('blur', function() {
                    validatePassword(this, 'signupPasswordError');
                });
            }
            
            // Forgot password validation
            const resetEmail = document.getElementById('resetEmail');
            
            if (resetEmail) {
                resetEmail.addEventListener('blur', function() {
                    validateEmail(this, 'resetEmailError');
                });
            }
        }

        // Validate email field
        function validateEmail(field, errorId) {
            const errorElement = document.getElementById(errorId);
            const parent = field.closest('.form-input-group');
            
            if (!field.value || !/\S+@\S+\.\S+/.test(field.value)) {
                parent.classList.add('error');
                errorElement.textContent = 'Please enter a valid email address';
                return false;
            } else {
                parent.classList.remove('error');
                return true;
            }
        }

        // Validate required field
        function validateField(field, errorId, errorMessage) {
            const errorElement = document.getElementById(errorId);
            const parent = field.closest('.form-input-group');
            
            if (!field.value.trim()) {
                parent.classList.add('error');
                errorElement.textContent = errorMessage;
                return false;
            } else {
                parent.classList.remove('error');
                return true;
            }
        }

        // Validate password field
        function validatePassword(field, errorId) {
            const errorElement = document.getElementById(errorId);
            const parent = field.closest('.form-input-group');
            
            if (!field.value || field.value.length < 8) {
                parent.classList.add('error');
                errorElement.textContent = 'Password must be at least 8 characters';
                return false;
            } else {
                parent.classList.remove('error');
                return true;
            }
        }

        // Load vendors from localStorage
        function loadVendors() {
            try {
                const savedVendors = localStorage.getItem('vendors');
                if (savedVendors) {
                    vendors = JSON.parse(savedVendors);
                    // Clear existing vendors to start fresh
                    if (vendors.length > 0) {
                        vendors = [];
                        saveVendors();
                    }
                    renderVendors();
                } else {
                    // Start with empty vendors array
                    vendors = [];
                    saveVendors();
                    renderVendors();
                }
            } catch (error) {
                console.error("Error loading vendors:", error);
                showToast("Error loading vendors", true);
                // Start with empty vendors array as fallback
                vendors = [];
                renderVendors();
            }
        }

        // Save vendors to localStorage
        function saveVendors() {
            try {
                localStorage.setItem('vendors', JSON.stringify(vendors));
            } catch (error) {
                console.error("Error saving vendors:", error);
                showToast("Error saving vendor data", true);
            }
        }

        // Render vendors to the page
        function renderVendors() {
            applySearchAndFilter(); // This will render the filtered and sorted vendors
        }

        // Load cart from localStorage on page load
        function loadCart() {
            try {
                const savedCart = sessionStorage.getItem('cart');
                if (savedCart) {
                    cart = JSON.parse(savedCart);
                    updateCartCount();
                }
            } catch (error) {
                console.error("Error loading cart:", error);
                showToast("Error loading cart", true);
            }
        }

        // Save cart to localStorage
        function saveCart() {
            try {
                sessionStorage.setItem('cart', JSON.stringify(cart));
            } catch (error) {
                console.error("Error saving cart:", error);
                showToast("Error saving cart", true);
            }
        }

        // Check background color for social icons
        function checkBackgroundColor() {
            try {
                const heroSection = document.querySelector('.hero');
                const socialIcons = document.querySelector('.social-icons');
                
                if (!heroSection || !socialIcons) return;
                
                // Get position of social icons
                const rect = socialIcons.getBoundingClientRect();
                const centerY = rect.top + (rect.height / 2);
                
                // Get element at that position
                const elementAtCenter = document.elementFromPoint(rect.left + (rect.width / 2), centerY);
                
                // Check if it's the hero section (dark background)
                if (elementAtCenter === heroSection || heroSection.contains(elementAtCenter)) {
                    document.body.classList.add('dark-bg');
                } else {
                    document.body.classList.remove('dark-bg');
                }
            } catch (error) {
                console.error("Error checking background color:", error);
            }
        }

        // Toggle vendor fields visibility
        function toggleVendorFields() {
            try {
                const userType = document.getElementById('userType').value;
                const vendorFields = document.getElementById('vendorFields');
                
                if (userType === 'seller') {
                    vendorFields.style.display = 'flex';
                    vendorFields.setAttribute('aria-hidden', 'false');
                } else {
                    vendorFields.style.display = 'none';
                    vendorFields.setAttribute('aria-hidden', 'true');
                }
            } catch (error) {
                console.error("Error toggling vendor fields:", error);
                showToast("Error updating form", true);
            }
        }

        // Preview uploaded images
        function previewImage(input, previewId) {
            const previewContainer = document.getElementById(previewId);
            previewContainer.innerHTML = '';
            
            if (input.files) {
                const files = input.files;
                
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        const previewItem = document.createElement('div');
                        previewItem.className = 'preview-item';
                        
                        const img = document.createElement('img');
                        img.src = e.target.result;
                        img.alt = `Preview image ${i + 1}`;
                        
                        const removeBtn = document.createElement('div');
                        removeBtn.className = 'remove-image';
                        removeBtn.innerHTML = '<i class="fas fa-times"></i>';
                        removeBtn.setAttribute('aria-label', 'Remove image');
                        removeBtn.onclick = function() {
                            previewItem.remove();
                            // Clear the file input
                            input.value = '';
                        };
                        
                        previewItem.appendChild(img);
                        previewItem.appendChild(removeBtn);
                        previewContainer.appendChild(previewItem);
                    }
                    
                    reader.readAsDataURL(file);
                }
            }
        }

        // Show restaurant detail page
        function showRestaurantDetail(restaurantId) {
            try {
                const restaurant = vendors.find(v => v.id === restaurantId);
                if (!restaurant) {
                    showToast("Restaurant not found", true);
                    return;
                }
                
                // Hide home page, show detail page
                homePage.style.display = 'none';
                restaurantDetailPage.style.display = 'block';
                restaurantDetailPage.setAttribute('aria-hidden', 'false');
                
                // Scroll to top
                window.scrollTo(0, 0);
                
                // Generate restaurant detail HTML
                let detailHTML = `
                    <a href="#" class="back-button" onclick="goBackToHome(); return false;" aria-label="Go back to vendors list">
                        <i class="fas fa-arrow-left" aria-hidden="true"></i> Back to Vendors
                    </a>
                    
                    <div class="restaurant-header">
                        <div class="restaurant-hero">
                            <img src="${restaurant.photos && restaurant.photos.length > 0 ? restaurant.photos[0] : 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-1.2.1&auto=format&fit=crop&w=1600&q=80'}" alt="${restaurant.businessName}">
                        </div>
                        
                        <div class="restaurant-info">
                            <div class="restaurant-title">
                                <h1>${restaurant.businessName}</h1>
                                <span class="vendor-badge">${restaurant.businessType || 'Food Vendor'}</span>
                            </div>
                            
                            <div class="restaurant-meta">
                                <div class="meta-item">
                                    <i class="fas fa-star" aria-hidden="true"></i>
                                    <span>${restaurant.rating || 4.0} (${restaurant.reviewCount || 0} reviews)</span>
                                </div>
                                <div class="meta-item">
                                    <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                                    <span>${restaurant.businessLocation || 'Nairobi, Kenya'}</span>
                                </div>
                                <div class="meta-item">
                                    <i class="fas fa-clock" aria-hidden="true"></i>
                                    <span>${restaurant.deliveryTime || 45} min</span>
                                </div>
                                <div class="meta-item">
                                    <i class="fas fa-truck" aria-hidden="true"></i>
                                    <span>Delivery: KSh 100</span>
                                </div>
                                <div class="meta-item">
                                    <i class="fas fa-shopping-bag" aria-hidden="true"></i>
                                    <span>Min order: KSh ${restaurant.minPrice || 300}</span>
                                </div>
                            </div>
                            
                            <div class="restaurant-description">
                                <p>${restaurant.description || 'Delicious food made with love and tradition.'}</p>
                            </div>
                            
                            <div class="restaurant-actions">
                                <button class="btn" onclick="showToast('Restaurant added to favorites!')" aria-label="Add restaurant to favorites">
                                    <i class="far fa-heart" aria-hidden="true"></i> Add to Favorites
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="menu-section">
                        <h2>Menu</h2>
                        <div class="empty-state">
                            <i class="fas fa-utensils" aria-hidden="true"></i>
                            <h3>Menu Coming Soon</h3>
                            <p>This vendor is still setting up their menu. Check back later!</p>
                        </div>
                    </div>
                    
                    <div class="reviews-section">
                        <h2>Customer Reviews</h2>
                        <div class="empty-state">
                            <i class="fas fa-comments" aria-hidden="true"></i>
                            <h3>No Reviews Yet</h3>
                            <p>Be the first to review this vendor!</p>
                        </div>
                    </div>
                `;
                
                // Set the HTML content
                restaurantDetailPage.innerHTML = detailHTML;
            } catch (error) {
                console.error("Error showing restaurant detail:", error);
                showToast("Error loading restaurant details", true);
            }
        }

        // Go back to home page
        function goBackToHome() {
            homePage.style.display = 'block';
            restaurantDetailPage.style.display = 'none';
            restaurantDetailPage.setAttribute('aria-hidden', 'true');
            window.scrollTo(0, 0);
        }

        // Auth state listener
        function simulateAuthState() {
            if (sessionStorage.getItem('isLoggedIn') === 'true') {
                isLoggedIn = true;
                const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');
                currentUser = userData;
                
                authLink.innerHTML = '<i class="fas fa-sign-out-alt"></i> <span class="nav-text">Logout</span>';
                authLink.onclick = logout;
                authLink.setAttribute('aria-label', 'Logout');
                
                // Show vendor dashboard link if user is a seller
                if (userData.userType === 'seller') {
                    vendorDashboardLink.style.display = 'list-item';
                }
            } else {
                isLoggedIn = false;
                currentUser = null;
                authLink.innerHTML = '<i class="fas fa-user"></i> <span class="nav-text">Login</span>';
                authLink.onclick = showLoginModal;
                authLink.setAttribute('aria-label', 'Login');
                vendorDashboardLink.style.display = 'none';
            }
        }

        // Show login modal
        function showLoginModal() {
            try {
                closeModals();
                overlay.style.display = 'block';
                loginModal.style.display = 'block';
                loginModal.setAttribute('aria-hidden', 'false');
                protectedOverlay.style.display = 'none';
                document.getElementById('loginEmail').focus();
            } catch (error) {
                console.error("Error showing login modal:", error);
                showToast("Error opening login form", true);
            }
        }

        // Show signup modal
        function showSignupModal() {
            try {
                closeModals();
                overlay.style.display = 'block';
                signupModal.style.display = 'block';
                signupModal.setAttribute('aria-hidden', 'false');
                protectedOverlay.style.display = 'none';
                document.getElementById('signupName').focus();
            } catch (error) {
                console.error("Error showing signup modal:", error);
                showToast("Error opening signup form", true);
            }
        }

        // Show forgot password modal
        function showForgotPassword() {
            try {
                closeModals();
                overlay.style.display = 'block';
                forgotPasswordModal.style.display = 'block';
                forgotPasswordModal.setAttribute('aria-hidden', 'false');
                document.getElementById('resetEmail').focus();
            } catch (error) {
                console.error("Error showing forgot password modal:", error);
                showToast("Error opening password reset form", true);
            }
        }

        // Close all modals
        function closeModals() {
            try {
                overlay.style.display = 'none';
                loginModal.style.display = 'none';
                loginModal.setAttribute('aria-hidden', 'true');
                signupModal.style.display = 'none';
                signupModal.setAttribute('aria-hidden', 'true');
                forgotPasswordModal.style.display = 'none';
                forgotPasswordModal.setAttribute('aria-hidden', 'true');
            } catch (error) {
                console.error("Error closing modals:", error);
            }
        }

        // Switch to signup form
        function switchToSignup() {
            try {
                loginModal.style.display = 'none';
                forgotPasswordModal.style.display = 'none';
                signupModal.style.display = 'block';
                signupModal.setAttribute('aria-hidden', 'false');
                document.getElementById('signupName').focus();
            } catch (error) {
                console.error("Error switching to signup:", error);
                showToast("Error switching forms", true);
            }
        }

        // Switch to login form
        function switchToLogin() {
            try {
                signupModal.style.display = 'none';
                forgotPasswordModal.style.display = 'none';
                loginModal.style.display = 'block';
                loginModal.setAttribute('aria-hidden', 'false');
                document.getElementById('loginEmail').focus();
            } catch (error) {
                console.error("Error switching to login:", error);
                showToast("Error switching forms", true);
            }
        }

        // Performance optimization: Debounce function
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Preload critical images
        function preloadCriticalImages() {
            const criticalImages = [
                'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-1.2.1&auto=format&fit=crop&w=1600&q=80'
            ];
            
            criticalImages.forEach(src => {
                const img = new Image();
                img.src = src;
            });
        }

        // ===== USER EXPERIENCE: ENHANCED LOADING STATES =====
        function showLoadingState(button, text = 'Processing...') {
            const originalText = button.innerHTML;
            button.innerHTML = `<span class="loading"></span> ${text}`;
            button.classList.add('loading');
            button.disabled = true;
            return originalText;
        }

        function hideLoadingState(button, originalText) {
            button.innerHTML = originalText;
            button.classList.remove('loading');
            button.disabled = false;
        }

        // Login function
        function login() {
            try {
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                const rememberMe = document.getElementById('rememberMe').checked;

                // Validate form
                const isEmailValid = validateEmail(document.getElementById('loginEmail'), 'loginEmailError');
                const isPasswordValid = validateField(document.getElementById('loginPassword'), 'loginPasswordError', 'Please enter your password');
                
                if (!isEmailValid || !isPasswordValid) {
                    showToast("Please fix the errors in the form", true);
                    return;
                }

                // Show enhanced loading state
                const loginButton = document.getElementById('loginButton');
                const originalText = showLoadingState(loginButton, 'Signing in...');
                
                showToast("Logging in...");
                
                // Simulate login process
                setTimeout(() => {
                    // For demo purposes, create a simple user object
                    const userData = {
                        email: email,
                        name: email.split('@')[0],
                        userType: 'buyer' // Default to buyer
                    };
                    
                    sessionStorage.setItem('isLoggedIn', 'true');
                    sessionStorage.setItem('userData', JSON.stringify(userData));
                    
                    // If remember me is checked, store in localStorage
                    if (rememberMe) {
                        localStorage.setItem('rememberedEmail', email);
                    }
                    
                    simulateAuthState();
                    closeModals();
                    showToast("Login successful!", false, 'success');
                    isLoggedIn = true;
                    currentUser = userData;
                    
                    // Remove loading state
                    hideLoadingState(loginButton, originalText);
                }, 1500);
            } catch (error) {
                console.error("Login error:", error);
                showToast("An unexpected error occurred", true);
                
                // Remove loading state
                const loginButton = document.getElementById('loginButton');
                if (loginButton) {
                    hideLoadingState(loginButton, 'Login');
                }
            }
        }

        // Signup function
        function signup() {
            try {
                const name = document.getElementById('signupName').value;
                const email = document.getElementById('signupEmail').value;
                const password = document.getElementById('signupPassword').value;
                const userType = document.getElementById('userType').value;
                const termsAgreed = document.getElementById('termsAgree').checked;

                // Validate form
                const isNameValid = validateField(document.getElementById('signupName'), 'signupNameError', 'Please enter your full name');
                const isEmailValid = validateEmail(document.getElementById('signupEmail'), 'signupEmailError');
                const isPasswordValid = validatePassword(document.getElementById('signupPassword'), 'signupPasswordError');
                
                if (!isNameValid || !isEmailValid || !isPasswordValid) {
                    showToast("Please fix the errors in the form", true);
                    return;
                }
                
                if (!termsAgreed) {
                    showToast("Please agree to the Terms of Service and Privacy Policy", true);
                    return;
                }

                // Additional validation for sellers
                if (userType === 'seller') {
                    const businessName = document.getElementById('businessName').value;
                    const businessLocation = document.getElementById('businessLocation').value;
                    const foodHandlersCert = document.getElementById('foodHandlersCert').value;
                    
                    if (!businessName || !businessLocation || !foodHandlersCert) {
                        showToast("As a seller, please provide your business details for verification", true);
                        return;
                    }
                }

                // Show enhanced loading state
                const signupButton = document.getElementById('signupButton');
                const originalText = showLoadingState(signupButton, 'Creating account...');
                
                showToast("Creating account...");
                
                // Simulate signup process
                setTimeout(() => {
                    const userData = {
                        name: name,
                        email: email,
                        userType: userType
                    };
                    
                    // If user is a seller, create a vendor profile
                    if (userType === 'seller') {
                        const businessName = document.getElementById('businessName').value;
                        const businessLocation = document.getElementById('businessLocation').value;
                        const description = document.getElementById('description').value;
                        
                        const vendor = {
                            id: 'vendor-' + Date.now(),
                            businessName: businessName,
                            businessLocation: businessLocation,
                            description: description,
                            owner: email,
                            businessType: document.querySelector('select') ? document.querySelector('select').value : 'Food Vendor',
                            // In a real app, you would handle file uploads properly
                            logo: 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80',
                            photos: ['https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80']
                        };
                        
                        vendors.push(vendor);
                        saveVendors();
                        renderVendors();
                    }
                    
                    sessionStorage.setItem('isLoggedIn', 'true');
                    sessionStorage.setItem('userData', JSON.stringify(userData));
                    simulateAuthState();
                    closeModals();
                    if (userType === 'seller') {
                        showToast("Account created! Seller verification pending.", false, 'success');
                    } else {
                        showToast("Account created successfully!", false, 'success');
                    }
                    isLoggedIn = true;
                    currentUser = userData;
                    
                    // Remove loading state
                    hideLoadingState(signupButton, originalText);
                }, 2000);
            } catch (error) {
                console.error("Signup error:", error);
                showToast("An unexpected error occurred", true);
                
                // Remove loading state
                const signupButton = document.getElementById('signupButton');
                if (signupButton) {
                    hideLoadingState(signupButton, 'Create Account');
                }
            }
        }

        // Reset password function
        function resetPassword() {
            try {
                const email = document.getElementById('resetEmail').value;
                
                // Validate email
                const isEmailValid = validateEmail(document.getElementById('resetEmail'), 'resetEmailError');
                
                if (!isEmailValid) {
                    showToast("Please enter a valid email address", true);
                    return;
                }

                // Show enhanced loading state
                const resetButton = document.getElementById('resetPasswordButton');
                const originalText = showLoadingState(resetButton, 'Sending...');
                
                showToast("Sending reset instructions...");
                
                // Simulate reset process
                setTimeout(() => {
                    closeModals();
                    showToast("Password reset instructions sent to your email", false, 'success');
                    
                    // Remove loading state
                    hideLoadingState(resetButton, originalText);
                }, 1500);
            } catch (error) {
                console.error("Reset password error:", error);
                showToast("An unexpected error occurred", true);
                
                // Remove loading state
                const resetButton = document.getElementById('resetPasswordButton');
                if (resetButton) {
                    hideLoadingState(resetButton, 'Send Reset Link');
                }
            }
        }

        // Google sign-in
        function signInWithGoogle() {
            try {
                showToast("Signing in with Google...");
                
                // Show loading state
                const googleButton = document.querySelector('.social-btn.google');
                const originalText = googleButton.innerHTML;
                googleButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Connecting...';
                googleButton.disabled = true;
                
                // Simulate Google login process
                setTimeout(() => {
                    const userData = {
                        name: 'Google User',
                        email: 'googleuser@example.com',
                        userType: 'buyer'
                    };
                    
                    sessionStorage.setItem('isLoggedIn', 'true');
                    sessionStorage.setItem('userData', JSON.stringify(userData));
                    simulateAuthState();
                    closeModals();
                    showToast("Google login successful!", false, 'success');
                    isLoggedIn = true;
                    currentUser = userData;
                    
                    // Restore button
                    googleButton.innerHTML = originalText;
                    googleButton.disabled = false;
                }, 1200);
            } catch (error) {
                console.error("Google sign-in error:", error);
                showToast("An unexpected error occurred", true);
                
                // Restore button on error
                const googleButton = document.querySelector('.social-btn.google');
                if (googleButton) {
                    googleButton.innerHTML = '<i class="fab fa-google"></i> Google';
                    googleButton.disabled = false;
                }
            }
        }

        // Facebook sign-in
        function signInWithFacebook() {
            try {
                showToast("Signing in with Facebook...");
                
                // Show loading state
                const facebookButton = document.querySelector('.social-btn.facebook');
                const originalText = facebookButton.innerHTML;
                facebookButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Connecting...';
                facebookButton.disabled = true;
                
                // Simulate Facebook login process
                setTimeout(() => {
                    const userData = {
                        name: 'Facebook User',
                        email: 'facebookuser@example.com',
                        userType: 'buyer'
                    };
                    
                    sessionStorage.setItem('isLoggedIn', 'true');
                    sessionStorage.setItem('userData', JSON.stringify(userData));
                    simulateAuthState();
                    closeModals();
                    showToast("Facebook login successful!", false, 'success');
                    isLoggedIn = true;
                    currentUser = userData;
                    
                    // Restore button
                    facebookButton.innerHTML = originalText;
                    facebookButton.disabled = false;
                }, 1200);
            } catch (error) {
                console.error("Facebook sign-in error:", error);
                showToast("An unexpected error occurred", true);
                
                // Restore button on error
                const facebookButton = document.querySelector('.social-btn.facebook');
                if (facebookButton) {
                    facebookButton.innerHTML = '<i class="fab fa-facebook-f"></i> Facebook';
                    facebookButton.disabled = false;
                }
            }
        }

        // Logout function
        function logout() {
            try {
                showToast("Logging out...");
                setTimeout(() => {
                    sessionStorage.removeItem('isLoggedIn');
                    sessionStorage.removeItem('userData');
                    simulateAuthState();
                    showToast("Logged out successfully", false, 'success');
                    isLoggedIn = false;
                    currentUser = null;
                    cart = [];
                    updateCartCount();
                    saveCart();
                }, 800);
            } catch (error) {
                console.error("Logout error:", error);
                showToast("An unexpected error occurred", true);
            }
        }

        // Show vendor dashboard
        function showVendorDashboard() {
            if (!isLoggedIn || currentUser.userType !== 'seller') {
                showToast("Vendor dashboard is only available for sellers", true);
                return;
            }
            
            // Redirect to vendor dashboard page
            window.location.href = "vendor-dashboard.html";
        }

        // Add to cart function
        function addToCart(itemName, itemPrice) {
            try {
                if (!isLoggedIn) {
                    protectedOverlay.style.display = 'flex';
                    return;
                }

                cart.push({
                    name: itemName,
                    price: itemPrice,
                    id: Date.now().toString()
                });
                updateCartCount();
                saveCart();
                
                showToast(`${itemName} added to cart!`, false, 'success');
            } catch (error) {
                console.error("Add to cart error:", error);
                showToast("Error adding item to cart", true);
            }
        }

        // Remove from cart function
        function removeFromCart(itemId) {
            try {
                cart = cart.filter(item => item.id !== itemId);
                updateCartCount();
                saveCart();
                showToast("Item removed from cart");
            } catch (error) {
                console.error("Remove from cart error:", error);
                showToast("Error removing item from cart", true);
            }
        }

        // Update cart count
        function updateCartCount() {
            try {
                cartCount.textContent = cart.length;
                cartCount.style.display = cart.length > 0 ? 'flex' : 'none';
            } catch (error) {
                console.error("Update cart count error:", error);
            }
        }

        // Show cart
        function showCart() {
            try {
                if (!isLoggedIn) {
                    protectedOverlay.style.display = 'flex';
                    return;
                }

                if (cart.length === 0) {
                    showToast("Your cart is empty!");
                    return;
                }

                // Create cart modal
                const cartModal = document.createElement('div');
                cartModal.className = 'auth-modal';
                cartModal.style.display = 'block';
                cartModal.setAttribute('aria-modal', 'true');
                cartModal.setAttribute('role', 'dialog');
                cartModal.setAttribute('aria-labelledby', 'cart-heading');
                
                let cartContent = `
                    <span class="close" onclick="this.parentElement.remove(); document.querySelector('.overlay:not(#overlay)').remove()" aria-label="Close cart"></span>
                    <h2 id="cart-heading">Your Cart</h2>
                    <div style="max-height: 300px; overflow-y: auto; margin-bottom: 20px;">
                `;
                
                let total = 0;
                
                cart.forEach(item => {
                    cartContent += `
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #eee;">
                            <div>
                                <h3 style="margin: 0 0 5px; font-size: 1.1rem;">${item.name}</h3>
                                <p style="margin: 0; color: #666;">KSh ${item.price}</p>
                            </div>
                            <button onclick="removeFromCart('${item.id}')" style="background: var(--accent); color: white; border: none; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer;" aria-label="Remove ${item.name} from cart">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    `;
                    total += item.price;
                });

                cartContent += `
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; font-weight: 700; font-size: 1.2rem; padding: 10px 0; border-top: 2px solid var(--secondary);">
                        <span>Total:</span>
                        <span>KSh ${total}</span>
                    </div>
                    <button onclick="showCheckout()" class="btn" style="margin-top: 20px;" aria-label="Proceed to checkout">Proceed to Checkout</button>
                `;
                
                cartModal.innerHTML = cartContent;
                document.body.appendChild(cartModal);
                
                // Add overlay
                const cartOverlay = document.createElement('div');
                cartOverlay.className = 'overlay';
                cartOverlay.style.display = 'block';
                cartOverlay.onclick = () => {
                    cartModal.remove();
                    cartOverlay.remove();
                };
                document.body.appendChild(cartOverlay);

                // Focus management for accessibility
                setTimeout(() => {
                    cartModal.querySelector('.close').focus();
                }, 100);
            } catch (error) {
                console.error("Show cart error:", error);
                showToast("Error displaying cart", true);
            }
        }

        // Show checkout modal
        function showCheckout() {
            try {
                // Close cart modal first
                document.querySelector('.auth-modal').remove();
                document.querySelector('.overlay').remove();
                
                // Calculate total
                let total = 0;
                let itemsHTML = '';
                
                cart.forEach(item => {
                    itemsHTML += `
                        <div class="checkout-item">
                            <span>${item.name}</span>
                            <span>KSh ${item.price}</span>
                        </div>
                    `;
                    total += item.price;
                });
                
                // Update checkout items and total
                checkoutItems.innerHTML = itemsHTML;
                checkoutTotal.textContent = `KSh ${total}`;
                
                // Show checkout modal
                overlay.style.display = 'block';
                checkoutModal.style.display = 'block';
                checkoutModal.setAttribute('aria-hidden', 'false');

                // Focus management for accessibility
                setTimeout(() => {
                    checkoutModal.querySelector('.close').focus();
                }, 100);
            } catch (error) {
                console.error("Show checkout error:", error);
                showToast("Error loading checkout", true);
            }
        }

        // Close checkout modal
        function closeCheckout() {
            checkoutModal.style.display = 'none';
            checkoutModal.setAttribute('aria-hidden', 'true');
            overlay.style.display = 'none';
        }

        // Select payment method
        function selectPayment(method) {
            selectedPaymentMethod = method;
            
            // Remove active class from all options
            document.querySelectorAll('.payment-option').forEach(option => {
                option.classList.remove('active');
                option.setAttribute('aria-selected', 'false');
            });
            
            // Add active class to selected option
            const selectedOption = event.target.closest('.payment-option');
            selectedOption.classList.add('active');
            selectedOption.setAttribute('aria-selected', 'true');
            
            // Show appropriate form
            document.getElementById('mpesaForm').style.display = method === 'mpesa' ? 'block' : 'none';
            document.getElementById('cardForm').style.display = method === 'card' ? 'block' : 'none';
            document.getElementById('cashForm').style.display = method === 'cash' ? 'block' : 'none';
        }

        // Pay with M-Pesa
        function payWithMpesa() {
            const phone = document.getElementById('mpesaPhone').value;
            
            if (!phone) {
                showToast("Please enter your phone number", true);
                return;
            }
            
            showToast("Sending M-Pesa request...");
            
            // Simulate M-Pesa payment
            setTimeout(() => {
                closeCheckout();
                placeOrder();
                showToast("Payment successful! Order placed.", false, 'success');
            }, 2000);
        }

        // Pay with card
        function payWithCard() {
            const cardNumber = document.getElementById('cardNumber').value;
            const cardExpiry = document.getElementById('cardExpiry').value;
            const cardCvv = document.getElementById('cardCvv').value;
            
            if (!cardNumber || !cardExpiry || !cardCvv) {
                showToast("Please fill in all card details", true);
                return;
            }
            
            showToast("Processing card payment...");
            
            // Simulate card payment
            setTimeout(() => {
                closeCheckout();
                placeOrder();
                showToast("Payment successful! Order placed.", false, 'success');
            }, 2000);
        }

        // Place order (for cash payment)
        function placeOrder() {
            showToast("Order placed successfully!", false, 'success');
            
            // Clear cart
            cart = [];
            updateCartCount();
            saveCart();
            
            // Close checkout modal
            closeCheckout();
        }

        // Show toast notification
        function showToast(message, isError = false, type = 'default') {
            try {
                // Remove existing toasts
                const existingToast = document.querySelector('.toast');
                if (existingToast) existingToast.remove();
                
                const toast = document.createElement('div');
                toast.className = `toast ${isError ? 'error' : type === 'success' ? 'success' : ''}`;
                toast.textContent = message;
                toast.setAttribute('role', 'alert');
                toast.setAttribute('aria-live', 'polite');
                document.body.appendChild(toast);
                
                // Show the toast
                toast.style.display = 'block';
                
                // Auto-remove after animation
                setTimeout(() => {
                    toast.remove();
                }, 4000);
            } catch (error) {
                console.error("Toast error:", error);
            }
        }

        // Close modals when clicking overlay
        overlay.addEventListener('click', closeModals);
        protectedOverlay.addEventListener('click', () => {
            protectedOverlay.style.display = 'none';
        });

        // Prevent modal close when clicking inside modal
        loginModal.addEventListener('click', (e) => e.stopPropagation());
        signupModal.addEventListener('click', (e) => e.stopPropagation());
        forgotPasswordModal.addEventListener('click', (e) => e.stopPropagation());
        checkoutModal.addEventListener('click', (e) => e.stopPropagation());

        // Initialize the app
        window.addEventListener('DOMContentLoaded', () => {
            init();
            simulateAuthState();
            
            // Check if there's a remembered email
            const rememberedEmail = localStorage.getItem('rememberedEmail');
            if (rememberedEmail) {
                document.getElementById('loginEmail').value = rememberedEmail;
                document.getElementById('rememberMe').checked = true;
            }
        });

        window.addEventListener('resize', debounce(checkBackgroundColor, 100));
        window.addEventListener('scroll', debounce(checkBackgroundColor, 100));
    </script>
</body>
</html>